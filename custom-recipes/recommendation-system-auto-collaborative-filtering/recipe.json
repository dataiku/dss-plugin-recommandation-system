{
    "meta": {
        "label": "Auto collaborative filtering",
        "description": "Compute collaborative filtering scores from a dataset of user-item samples",
        "icon": "icon-beer"
    },
    "kind": "PYTHON",
    "selectableFromDataset": "samples_dataset",
    "inputRoles": [
        {
            "name": "samples_dataset",
            "label": "Samples dataset",
            "description": "Dataset of user-item samples",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": true,
            "mustBeSQL": true
        }
    ],
    "outputRoles": [
        {
            "name": "scored_samples_dataset",
            "label": "Scored samples dataset",
            "description": "Dataset of user-item samples with collaborative filtering scores",
            "arity": "UNARY",
            "required": true,
            "acceptsDataset": true,
            "mustBeSQL": true
        },
        {
            "name": "similarity_scores_dataset",
            "label": "(Optional) Similarity scores dataset",
            "description": "Dataset of similarity scores used to compute the collaborative filtering scores",
            "arity": "UNARY",
            "required": false,
            "acceptsDataset": true,
            "mustBeSQL": true
        }
    ],
    "params": [
        {
            "type": "SEPARATOR",
            "name": "separator_input",
            "label": "Input parameters"
        },
        {
            "name": "users_column_name",
            "label": "Users column",
            "allowedColumnTypes": [
                "tinyint",
                "smallint",
                "int",
                "bigint",
                "float",
                "double",
                "string"
            ],
            "type": "COLUMN",
            "description": "",
            "columnRole": "samples_dataset",
            "mandatory": true
        },
        {
            "name": "items_column_name",
            "label": "Items column",
            "allowedColumnTypes": [
                "tinyint",
                "smallint",
                "int",
                "bigint",
                "float",
                "double",
                "string"
            ],
            "type": "COLUMN",
            "description": "",
            "columnRole": "samples_dataset",
            "mandatory": true
        },
        {
            "name": "ratings_column_name",
            "label": "(Optional) Ratings column",
            "allowedColumnTypes": [
                "tinyint",
                "smallint",
                "int",
                "bigint",
                "float",
                "double"
            ],
            "type": "COLUMN",
            "description": "",
            "columnRole": "samples_dataset",
            "mandatory": false
        },
        {
            "type": "SEPARATOR",
            "name": "separator_preprocessing",
            "label": "Pre-processing parameters"
        },
        {
            "name": "user_visit_threshold",
            "label": "Minimum visits per user",
            "description": "Keep only users with more item interaction.",
            "type": "INT",
            "defaultValue": 10
        },
        {
            "name": "item_visit_threshold",
            "label": "Minimum visits per item",
            "description": "Keep only items with more user interaction.",
            "type": "INT",
            "defaultValue": 10
        },
        {
            "name": "normalization_method",
            "label": "Normalization method",
            "description": "User-item visits are normalized using the selected method.",
            "type": "SELECT",
            "defaultValue": "l1_normalization",
            "selectChoices": [
                {
                    "value": "l1_normalization",
                    "label": "L1 normalization"
                },
                {
                    "value": "l2_normalization",
                    "label": "L2 normalization"
                }
            ]
        },
        {
            "name": "timestamp_filtering",
            "label": "Use timestamp filtering",
            "description": "Makes the computations faster but scores less user-item pairs.",
            "type": "BOOLEAN",
            "defaultValue": false
        },
        {
            "name": "timestamps_column_name",
            "label": "Timestamp column",
            "description": "Column used to order items per user (higher values means more recent).",
            "allowedColumnTypes": [
                "date",
                "tinyint",
                "smallint",
                "int",
                "bigint",
                "float",
                "double"
            ],
            "type": "COLUMN",
            "columnRole": "samples_dataset",
            "mandatory": false,
            "visibilityCondition": "model.timestamp_filtering"
        },
        {
            "name": "top_n_most_recent",
            "label": "Nb. of items to keep per user",
            "description": "Keep only the N most recent items per user based on the timestamp column.",
            "type": "INT",
            "defaultValue": 20,
            "visibilityCondition": "model.timestamp_filtering"
        },
        {
            "type": "SEPARATOR",
            "name": "separator_parameters",
            "label": "Collaborative filtering parameters"
        },
        {
            "name": "collaborative_filtering_method",
            "label": "Collaborative filtering method",
            "type": "SELECT",
            "defaultValue": "user_based",
            "selectChoices": [
                {
                    "value": "user_based",
                    "label": "User-based"
                },
                {
                    "value": "item_based",
                    "label": "Item-based"
                }
            ]
        },
        {
            "name": "top_n_most_similar",
            "label": "Nb. of most similar users/items",
            "description": "Keep only the top N most similar users/items to compute affinity scores.",
            "type": "INT",
            "defaultValue": 10
        }
    ],
    "resourceKeys": []
}